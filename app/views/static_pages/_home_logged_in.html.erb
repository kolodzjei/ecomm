<div class="container">
  <div class="row">
    <div class="col-md-3">
      <h3>Categories</h3>
      <div class="form-group">
      <%= form_tag root_path, method: :get do %>
        <div class="checkbox-list">
          <% Category.all.each do |category| %>
            <div class="checkbox">
              <%= check_box_tag "category_ids[]", category.id, params[:category_ids]&.include?(category.id.to_s), id: "category-#{category.id}" %>
              <%= label_tag "category-#{category.id}", category.name %>
            </div>
          <% end %>
        </div>
        <%= submit_tag "Filter", class: "btn btn-primary" %>
        <% if params[:search].present? %>
          <%= hidden_field_tag "search", params[:search] %>
        <% end %>
      <% end %>

      </div>
    </div>
    <div class="col-md-9">
      <h2>Products</h2>
      <div class="row">
        <% @products.each do |product| %>
          <div class="col-md-4">
            <div class="thumbnail">
              <a href="<%= product_path(product) %>">
                <% if product.image.attached? %>
                  <%= image_tag product.image.variant(:thumb), class:"img-responsive"%>
                <% end %>
              </a>
              <div class="caption">
                <h3><%= product.name %></h3>
                <p><%= number_to_currency(product.price) %></p>
                <p><%= product.description[0..10] %></p>
              </div>
            </div>
          </div>
        <% end %>
        <%== pagy_nav(@pagy) %>
      </div>
    </div>
  </div>
</div>